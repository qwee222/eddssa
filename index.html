<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Disp0 las 24 hrs" property="og:description">
<meta content="https://i.postimg.cc/Bnq5MpvX/Screenshot-756.png" property="og:image">
<script id="_wau271">var _wau = _wau || []; _wau.push(["small", "amarillo70", "271"]);</script><script async src="//waust.at/s.js"></script>
    
    <!-- DIRECTIVAS ANTI-INDEXACIÓN Y SEGURIDAD -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="referrer" content="no-referrer">

    <!-- Carga de Tailwind CSS (para estética y responsividad) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

    <!-- Configuración de Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'fuchsia-tiktok': '#e736a4',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos base para cubrir toda la pantalla */
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
            font-family: 'Inter', sans-serif;
        }

        /* Contenedor del video/GIF para asegurar que cubra toda la pantalla */
        .video-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
        }

        /* El video, escalado para ser adaptable y cubrir */
        #VideoBg {
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            object-fit: cover;
            opacity: 0.8;
            filter: brightness(0.9);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Animación para el botón de carga (Spinner) */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .animate-spin-custom {
            animation: spin 1s linear infinite;
        }
        
        /* Estilo base para los bloques de pasos */
        .step-block-item {
            display: none; /* Por defecto, oculto (se muestra con JS/Tailwind) */
        }
    </style>
</head>
<body class="font-sans">
    <!-- PANTALLA DE CARGA INICIAL (SE OCULTA CON JS AL FINALIZAR FIREBASE) -->
    <div id="loading-screen" class="fixed inset-0 bg-black flex items-center justify-center z-50 transition-opacity duration-500">
        <p class="text-white text-xl flex items-center">
            <svg class="animate-spin-custom -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Inicializando seguridad...
        </p>
    </div>

    <!-- CONTENEDOR PRINCIPAL DE LA APLICACIÓN (INICIALMENTE OPACIDAD 0) -->
    <div id="app-container" class="w-full h-screen flex flex-col items-center justify-center relative opacity-0 transition-opacity duration-500">
        
        <!-- DEBUG INFO (MÁXIMA DISCRECIÓN VISUAL) -->
        <div id="debug-info" class="absolute top-0 left-0 text-[8px] text-gray-900 px-0.5 py-0.25 rounded-br-lg bg-black/5 z-20">
            <p>App ID: <span id="app-id-display"></span></p>
            <p>User ID: <span id="user-id-display"></span></p>
            <p id="app-message" class="mt-0.5 font-bold"></p>
        </div>

        <!-- VIDEO DE FONDO -->
        <div class="video-wrapper">
            <video autoplay muted loop id="VideoBg">
                <source src="https://cdn.videy.co/pEvKWO9U1.mp4" type="video/mp4">
                Tu navegador no soporta el tag de video.
            </video>
        </div>

        <!-- CONTENEDOR DEL QUIZ/STEPS -->
        <div id="step-block" class="relative z-10 w-11/12 sm:w-3/4 max-w-lg bg-black/80 p-6 sm:p-8 rounded-xl shadow-2xl backdrop-blur-sm">

            <!-- LOGO/IMAGEN -->
            <div class="logo flex justify-center mb-6">
                <!-- Placeholder de imagen -->
                <img src="https://placehold.co/100x100/1a1a1a/e736a4?text=Rico!" alt="Logo de la Aplicación" class="w-20 h-20 rounded-full border-4 border-fuchsia-tiktok shadow-lg">
            </div>

            <!-- PASO 1: VERIFICACIÓN DE EDAD -->
            <div id="step-1" class="step-item step-block-item flex-col items-center">
                <div class="question-title text-white text-xl sm:text-2xl font-bold mb-8 text-center">
                    ¿Ofrezco mis servicios por horas, a domicilio, quieres ver mi catálogo?
                </div>
                <div class="buttons-block flex justify-center gap-4">
                    <button data-next="step-2" class="step-btn no-btn bg-white text-black font-bold py-3 px-8 rounded-lg text-lg hover:bg-gray-200 transition duration-150 shadow-md">
                        No
                    </button>
                    <button data-next="step-2" class="step-btn yes-btn bg-fuchsia-tiktok text-black font-bold py-3 px-8 rounded-lg text-lg hover:bg-pink-600 transition duration-150 shadow-md">
                        Sí
                    </button>
                </div>
            </div>

            <!-- PASO 2: MENSAJE FINAL / CTA -->
            <div id="step-2" class="step-item step-block-item flex-col items-center hidden">
                <div class="question-title text-white text-xl sm:text-2xl font-bold mb-4 text-center">
                    ¡Casi listo!
                </div>
                <p class="text-gray-300 text-center mb-8">
                    NOTA: ¿Estás de acuerdo en respetar a las mujeres desnudas que ves abajo? Presiona ACEPTO y confirma tu cita, Si conoces a alguien, por favor, no lo digas y no difundas rumores....
                </p>
                <div class="buttons-block flex justify-center">
                    <!-- Botón de Acción Final (Protegido por Anti-Bot) -->
                    <a 
                        id="btn-final-action"
                        href="https://clic.link0ff.com/amari" 
                        class="
                            text-center uppercase font-black text-xl sm:text-2xl 
                            py-4 px-8 rounded-xl transition-all duration-100 
                            border-4 border-white shadow-xl 
                            bg-fuchsia-tiktok text-black hover:scale-[1.03] 
                            shadow-[0_8px_0_-2px_#e736a4,0_8px_0_0_#000] 
                            active:shadow-[0_4px_0_-2px_#e736a4,0_4px_0_0_#000] 
                            active:translate-y-[4px]
                        "
                        role="button"
                    >
                        ACEPTO
                    </a>
                </div>
            </div>

            <!-- Campo Honeypot invisible (solo para bots) -->
            <form id="honeypot-form" class="absolute opacity-0 pointer-events-none w-0 h-0 overflow-hidden" aria-hidden="true">
                <label for="hp-field">Campo Anti-Spam (no llenar):</label>
                <input 
                    id="hp-field" 
                    name="honeypot" 
                    type="text" 
                    tabindex="-1" 
                    autocomplete="off"
                />
            </form>

        </div>
    </div>
    
    <script type="module">
        // === Importaciones de Firebase (CDN) ===
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore, doc, setDoc, collection, setLogLevel 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Establecer nivel de log para depuración de Firestore
        setLogLevel('error'); // Solo mostrar errores graves

        // === Variables Globales de Estado y Referencia ===
        const MIN_INTERACTION_TIME = 500; // 0.5 segundos: Clics más rápidos se consideran sospechosos
        let db;
        let auth;
        let userId = null;
        let isBotDetected = false;
        let loadTimeRef = Date.now();
        let isProcessing = false;
        let currentStepId = 'step-1';

        // Recuperar IDs globales del entorno (OBLIGATORIO)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        // @ts-ignore
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        // @ts-ignore
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // === Elementos del DOM ===
        const appContainer = document.getElementById('app-container');
        const loadingScreen = document.getElementById('loading-screen');
        const btnFinalAction = document.getElementById('btn-final-action');
        const hpField = document.getElementById('hp-field');
        const msgDisplay = document.getElementById('app-message');
        const userIdDisplay = document.getElementById('user-id-display');
        const appIdDisplay = document.getElementById('app-id-display');
        const stepItems = Array.from(document.querySelectorAll('.step-item'));


        // === LÓGICA DE FLUJO DEL QUIZ ===
        function showStep(stepId) {
            stepItems.forEach(item => {
                const isTarget = item.id === stepId;
                item.classList.toggle('hidden', !isTarget);
                item.classList.toggle('flex', isTarget);
            });
            currentStepId = stepId;
        }

        function handleStepClick(e) {
            const nextStepId = e.currentTarget.dataset.next;
            if (nextStepId) {
                showStep(nextStepId);
            }
        }
        
        // Asignar listeners a los botones de navegación (Sí/No)
        document.querySelectorAll('.step-btn').forEach(btn => {
            btn.addEventListener('click', handleStepClick);
        });


        // === LÓGICA DE SEGURIDAD Y FIREBASE ===

        // Función para mostrar mensajes de estado de forma temporal
        function displayMessage(message, isError = false) {
            msgDisplay.textContent = message;
            msgDisplay.className = isError 
                ? 'mt-0.5 font-bold text-red-600' 
                : 'mt-0.5 font-bold text-green-500';
            
            setTimeout(() => {
                msgDisplay.textContent = '';
                msgDisplay.className = 'mt-0.5 font-bold';
            }, 3000);
        }
        
        // Función para actualizar el texto y la apariencia del botón de acción final
        function updateFinalButton(text, isBlocked = false, isLoader = false) {
            btnFinalAction.innerHTML = text;
            if (isLoader) {
                // Añadir spinner SVG si está cargando
                btnFinalAction.innerHTML = `
                    <div class="flex items-center justify-center">
                        <svg class="animate-spin-custom -ml-1 mr-3 h-5 w-5 text-black" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        ${text}
                    </div>
                `;
            }

            // Cambiar clase para estado bloqueado o normal
            if (isBlocked) {
                btnFinalAction.className = btnFinalAction.className.replace(
                    /bg-fuchsia-tiktok text-black.*active:translate-y-\[4px\]/g, 
                    'bg-red-600 cursor-not-allowed text-white shadow-[0_8px_0_0_#900] active:translate-y-0'
                );
                btnFinalAction.href = 'javascript:void(0);'; // Desactivar el enlace
            } else {
                btnFinalAction.className = btnFinalAction.className.replace(
                    /bg-red-600 cursor-not-allowed text-white shadow-\[0_8px_0_0_#900\] active:translate-y-0/g, 
                    'bg-fuchsia-tiktok text-black hover:scale-\[1\.03\] cursor-pointer shadow-\[0\_8px\_0\_-2px\_#e736a4,0\_8px\_0\_0\_#000\] active:shadow-\[0\_4px\_0\_-2px\_#e736a4,0\_4px\_0\_0\_#000\] active:translate-y-\[4px\]'
                );
                // El href se asigna al final en handleEntry
            }
        }

        // Función de Detección de Bots
        function checkBotActivity() {
            let detected = false;
            let detectionReason = null;
            const clickTime = Date.now();
            const interactionTime = clickTime - loadTimeRef;

            // 1. Detección de Honeypot: Si el campo oculto está lleno
            if (hpField.value.length > 0) {
                detected = true;
                detectionReason = 'Honeypot Lleno';
            }

            // 2. Detección por Tiempo Mínimo de Interacción: Clic demasiado rápido
            if (interactionTime < MIN_INTERACTION_TIME && !detected) {
                detected = true;
                detectionReason = `Clic demasiado rápido (${interactionTime}ms)`;
            }

            if (detected) {
                isBotDetected = true;
                displayMessage(`Acceso Denegado. Actividad sospechosa: ${detectionReason}.`, true);
                updateFinalButton('BLOQUEADO', true);
            } else {
                isBotDetected = false;
            }
            
            return detected;
        }

        // Función para registrar el intento en Firestore
        async function logAccessAttempt(targetUrl, isBotStatus, statusMessage) {
            if (!db || !userId) {
                console.error("Firestore o userId no están inicializados. No se puede registrar el intento.");
                return;
            }
            try {
                const attemptData = {
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    isBot: isBotStatus,
                    status: statusMessage,
                    honeypotFilled: hpField.value.length > 0,
                    interactionTimeMs: Date.now() - loadTimeRef,
                    targetUrl: targetUrl,
                };
                
                const attemptsRef = collection(db, `artifacts/${appId}/users/${userId}/access_attempts`);
                const docRef = doc(attemptsRef, Date.now().toString());
                await setDoc(docRef, attemptData); 
                
            } catch (error) {
                console.error("Error al registrar el intento en Firestore:", error);
            }
        }

        // Función principal de entrada (al hacer clic en Acepto)
        async function handleEntry(e) {
            e.preventDefault();
            if (isProcessing || isBotDetected) return;

            isProcessing = true;
            updateFinalButton('PROCESANDO...', false, true); 
            
            const targetUrl = 'https://clic.link0ff.com/amari'; // Redirección fija
            
            // 1. Ejecutar las verificaciones Anti-Bot
            const isBot = checkBotActivity();

            if (isBot) {
                // Si es un bot, se registra el fallo y se bloquea el botón
                await logAccessAttempt(targetUrl, true, 'blocked_by_security');
                isProcessing = false;
                // El botón ya está actualizado por checkBotActivity
                return;
            }

            // 2. Si es usuario legítimo: se registra el éxito y se redirige
            displayMessage("¡Redirigiendo a Google!");
            await logAccessAttempt(targetUrl, false, 'success');
            
            // Redirección real
            setTimeout(() => {
                isProcessing = false;
                window.location.href = targetUrl;
            }, 500); 
        }

        // === Inicialización de Firebase y Autenticación ===
        async function initApp() {
            appIdDisplay.textContent = appId; // Mostrar App ID
            
            // 1. Mostrar el primer paso del quiz
            showStep(currentStepId);
            
            if (Object.keys(firebaseConfig).length === 0) {
                console.error("Firebase config is missing or invalid.");
                displayMessage("Error: Configuración de Firebase faltante.", true);
                loadingScreen.classList.add('opacity-0');
                loadingScreen.classList.add('hidden');
                appContainer.classList.add('opacity-100');
                return;
            }

            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            
            const signInUser = async () => {
                try {
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                } catch (error) {
                    console.error("Error signing in:", error);
                    // Fallback a ID aleatorio si la autenticación falla
                    userId = crypto.randomUUID();
                }
            };
            
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    userId = user.uid;
                } else if (!userId) {
                    signInUser();
                }

                if (userId) {
                    userIdDisplay.textContent = userId;
                    // Finalizar carga y mostrar la aplicación
                    loadingScreen.classList.add('opacity-0');
                    setTimeout(() => {
                        loadingScreen.classList.add('hidden');
                        appContainer.classList.add('opacity-100');
                        loadTimeRef = Date.now(); // Establecer tiempo de carga
                    }, 500);
                }
            });
            
            if (!initialAuthToken) {
                signInUser();
            }
        }
        
        // Asignar el listener al botón de acción final
        btnFinalAction.addEventListener('click', handleEntry);

        // Iniciar la aplicación al cargar el script
        initApp();
    </script>
</body>
</html>
